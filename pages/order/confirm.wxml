<!--pages/order/confirm.wxml-->
<view class="container">
  <!-- 返回按钮 -->
  <view class="back-button" bindtap="onGoBack">
    <text class="back-icon">←</text>
    <text class="back-text">返回</text>
  </view>
  
  <!-- 加载状态 -->
  <view class="loading" wx:if="{{loading}}">
    <text>加载中...</text>
  </view>

  <view wx:else>
    <!-- 收货地址 -->
    <view class="address-section card" bindtap="onSelectAddress">
      <view class="address-content" wx:if="{{selectedAddress}}">
        <view class="address-header">
          <text class="name">{{selectedAddress.name}}</text>
          <text class="phone">{{selectedAddress.phone}}</text>
        </view>
        <text class="address-detail">{{selectedAddress.province}}{{selectedAddress.city}}{{selectedAddress.district}}{{selectedAddress.detail}}</text>
        <text class="default-tag" wx:if="{{selectedAddress.isDefault}}">默认</text>
      </view>
      <view class="address-empty" wx:else>
        <text>请选择收货地址</text>
      </view>
      <text class="arrow">›</text>
    </view>

    <!-- 商品列表 -->
    <view class="products-section card">
      <text class="section-title">商品信息</text>
      <view class="order-items">
        <view class="order-item" wx:for="{{orderItems}}" wx:key="id">
          <image class="item-image" src="{{item.image}}" mode="aspectFill" />
          <view class="item-info">
            <text class="item-name">{{item.name}}</text>
            <text class="item-sku" wx:if="{{item.skuName}}">{{item.skuName}}</text>
            <view class="item-price">
              <text class="price">¥{{item.price}}</text>
              <text class="quantity">x{{item.quantity}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 支付方式 -->
    <view class="payment-section card">
      <text class="section-title">支付方式</text>
      <view class="payment-options">
        <view 
          class="payment-option {{selectedPayment === method.id ? 'selected' : ''}}"
          wx:for="{{paymentMethods}}"
          wx:key="id"
          data-method="{{method.id}}"
          bindtap="onSelectPayment"
        >
          <text class="payment-icon">{{method.icon}}</text>
          <text class="payment-name">{{method.name}}</text>
          <text class="payment-check">✓</text>
        </view>
      </view>
    </view>

    <!-- 备注 -->
    <view class="remark-section card">
      <text class="section-title">订单备注</text>
      <textarea 
        class="remark-input" 
        placeholder="请输入备注信息（选填）"
        value="{{remark}}"
        bindinput="onRemarkInput"
      />
    </view>

    <!-- 价格明细 -->
    <view class="price-section card">
      <view class="price-row">
        <text>商品金额</text>
        <text>¥{{totalPrice.toFixed(2)}}</text>
      </view>
      <view class="price-row">
        <text>运费</text>
        <text>¥0.00</text>
      </view>
      <view class="price-row total">
        <text>实付款</text>
        <text class="total-price">¥{{totalPrice.toFixed(2)}}</text>
      </view>
    </view>
  </view>

  <!-- 底部提交栏 -->
  <view class="submit-bar">
    <view class="total-price">
      <text>合计: </text>
      <text class="price">¥{{totalPrice.toFixed(2)}}</text>
    </view>
    <button class="submit-btn" bindtap="onSubmitOrder">提交订单</button>
  </view>
</view>