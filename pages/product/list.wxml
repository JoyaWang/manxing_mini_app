<!--pages/product/list.wxml-->
<view class="container">
  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-button" bindtap="onGoBack">
    <text class="back-icon">â†</text>
    <text class="back-text">è¿”å›</text>
  </view>
  
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <input 
      class="search-input" 
      placeholder="æœç´¢å•†å“" 
      value="{{filters.keyword}}"
      bindinput="onSearchInput"
      bindconfirm="onSearchConfirm"
    />
    <text class="icon-search">ğŸ”</text>
  </view>

  <!-- æ’åºå’Œç­›é€‰æ  -->
  <view class="filter-bar">
    <view class="filter-options">
      <view 
        class="filter-item {{showFilter ? 'active' : ''}}"
        bindtap="onToggleFilter"
      >
        <text>ç­›é€‰</text>
        <text class="icon-filter">âš™ï¸</text>
      </view>
      
      <view class="sort-options">
        <view 
          class="sort-item {{selectedSort.value === item.value && selectedSort.order === item.order ? 'active' : ''}}"
          wx:for="{{sortOptions}}"
          wx:key="value"
          data-sort="{{item}}"
          bindtap="onSelectSort"
        >
          <text>{{item.label}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel {{showFilter ? 'show' : ''}}">
    <view class="filter-content">
      <view class="filter-section">
        <text class="section-title">ä»·æ ¼èŒƒå›´</text>
        <view class="price-inputs">
          <input 
            class="price-input" 
            placeholder="æœ€ä½ä»·" 
            type="number"
            value="{{filters.minPrice}}"
            data-field="minPrice"
            bindinput="onPriceInput"
          />
          <text class="price-separator">-</text>
          <input 
            class="price-input" 
            placeholder="æœ€é«˜ä»·" 
            type="number"
            value="{{filters.maxPrice}}"
            data-field="maxPrice"
            bindinput="onPriceInput"
          />
        </view>
      </view>

      <view class="filter-actions">
        <button class="btn-reset" bindtap="onResetFilter">é‡ç½®</button>
        <button class="btn-apply" bindtap="onApplyFilter">åº”ç”¨</button>
      </view>
    </view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <scroll-view class="product-list" scroll-y bindscrolltolower="onReachBottom">
    <view class="product-grid">
      <view 
        class="product-card"
        wx:for="{{products}}"
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="onSelectProduct"
      >
        <image class="product-image" src="{{item.image}}" mode="aspectFill" />
        <view class="product-info">
          <text class="product-name">{{item.name}}</text>
          <view class="product-price">
            <text class="price">Â¥{{item.price}}</text>
            <text class="original-price" wx:if="{{item.originalPrice}}">Â¥{{item.originalPrice}}</text>
          </view>
          <text class="product-sales">å·²å”®{{item.sales || 0}}</text>
          <text class="product-tag" wx:if="{{item.isNew}}">æ–°å“</text>
          <text class="product-tag discount" wx:if="{{item.discount}}">ç‰¹ä»·</text>
        </view>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="load-more" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
    <view class="load-more" wx:if="{{!hasMore && !loading}}">
      <text>æ²¡æœ‰æ›´å¤šå•†å“äº†</text>
    </view>
  </scroll-view>

  <!-- é®ç½©å±‚ -->
  <view 
    class="mask {{showFilter ? 'show' : ''}}" 
    bindtap="onToggleFilter"
  ></view>
</view>